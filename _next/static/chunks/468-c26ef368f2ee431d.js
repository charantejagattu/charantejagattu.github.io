"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[468],{3468:(e,a,t)=>{t.d(a,{A:()=>c});var l=t(6001),s=t(9973),r=t(7915),n=t(7526),o=t.n(n),i=t(7523);function c(e){let{type:a}=e,[t,n]=(0,s.useState)(""),[c,m]=(0,s.useState)(""),[u,d]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[f,g]=(0,s.useState)(""),[x,N]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[j,y]=(0,s.useState)(""),[_,S]=(0,s.useState)(""),[k,C]=(0,s.useState)(""),[w,I]=(0,s.useState)(""),[F,T]=(0,s.useState)(""),[q,O]=(0,s.useState)(""),[P,E]=(0,s.useState)(""),[A,J]=(0,s.useState)("home"),[R,D]=(0,s.useState)("en"),[L,z]=(0,s.useState)(!0),[B,H]=(0,s.useState)(!0),[W,M]=(0,s.useState)(!1),[U,Z]=(0,s.useState)(["account_summary","recent_transactions","goals"]),[G,K]=(0,s.useState)("dark"),[Q,V]=(0,s.useState)("INR"),X=(0,r.useRouter)(),Y=async e=>{e.preventDefault(),d("");try{let e,l="",s={};if("login"===a)l="".concat("https://travis-2d4m.onrender.com/api/v1","/auth/login"),e=new URLSearchParams({username:t,password:c}),s["Content-Type"]="application/x-www-form-urlencoded",delete s.Authorization;else{l="".concat("https://travis-2d4m.onrender.com/api/v1","/auth/register");let a=x&&10===x.length?"".concat(x,"T00:00:00Z"):x;e=JSON.stringify({email:t,phone:h,full_name:f,password:c,date_of_birth:a,occupation:v,income_range:j,pan_number:_,addresses:[{line1:k,line2:w,city:F,state:q,country:"India",pincode:P,address_type:A}],preferences:{language:R,notification_email:L,notification_push:B,notification_sms:W,dashboard_widgets:U,theme:G,currency_display:Q}}),s["Content-Type"]="application/json",delete s.Authorization}let r=await fetch(l,{method:"POST",headers:s,body:e}),n=await r.json();r.ok?("login"===a?(0,i.h_)(n.access_token,"",JSON.stringify({user_id:n.user_id,email:n.email,full_name:n.full_name,expires_in:n.expires_in,token_type:n.token_type})):(0,i.h_)(n.accessToken,n.refreshToken,JSON.stringify({user_id:n.user_id,email:n.email,full_name:n.full_name,expires_in:n.expires_in,token_type:n.token_type})),window.dispatchEvent(new Event("authChanged")),X.push("/dashboard")):Array.isArray(n.detail)?d(n.detail.map(e=>{var a;return"".concat((null==(a=e.loc)?void 0:a.join("."))||"",": ").concat(e.msg||JSON.stringify(e))}).join(" | ")):"string"==typeof n.detail?d(n.detail):n.message?d(n.message):d("An error occurred")}catch(e){d("Failed to connect to the server")}};return(0,l.jsxs)("form",{onSubmit:Y,className:"card p-4",children:[u&&(0,l.jsx)("div",{className:"alert alert-danger",style:{whiteSpace:"pre-line"},children:u}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),(0,l.jsx)("input",{type:"email",className:"form-control",id:"email",value:t,onChange:e=>n(e.target.value),required:!0})]}),"register"===a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"fullName",className:"form-label",children:"Full Name"}),(0,l.jsx)("input",{type:"text",className:"form-control",id:"fullName",value:f,onChange:e=>g(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"phone",className:"form-label",children:"Phone"}),(0,l.jsx)("input",{type:"tel",className:"form-control",id:"phone",value:h,onChange:e=>p(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"dateOfBirth",className:"form-label",children:"Date of Birth"}),(0,l.jsx)("input",{type:"date",className:"form-control",id:"dateOfBirth",value:x,onChange:e=>N(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"occupation",className:"form-label",children:"Occupation"}),(0,l.jsx)("input",{type:"text",className:"form-control",id:"occupation",value:v,onChange:e=>b(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"incomeRange",className:"form-label",children:"Income Range"}),(0,l.jsx)("input",{type:"text",className:"form-control",id:"incomeRange",value:j,onChange:e=>y(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"panNumber",className:"form-label",children:"PAN Number"}),(0,l.jsx)("input",{type:"text",className:"form-control",id:"panNumber",value:_,onChange:e=>S(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Address"}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"Line 1",value:k,onChange:e=>C(e.target.value),required:!0}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"Line 2",value:w,onChange:e=>I(e.target.value)}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"City",value:F,onChange:e=>T(e.target.value),required:!0}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"State",value:q,onChange:e=>O(e.target.value),required:!0}),(0,l.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"Pincode",value:P,onChange:e=>E(e.target.value),required:!0}),(0,l.jsxs)("select",{className:"form-control",value:A,onChange:e=>J(e.target.value),children:[(0,l.jsx)("option",{value:"home",children:"Home"}),(0,l.jsx)("option",{value:"work",children:"Work"})]})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Preferences"}),(0,l.jsxs)("select",{className:"form-control mb-2",value:R,onChange:e=>D(e.target.value),children:[(0,l.jsx)("option",{value:"en",children:"English"}),(0,l.jsx)("option",{value:"hi",children:"Hindi"})]}),(0,l.jsxs)("div",{className:"form-check",children:[(0,l.jsx)("input",{className:"form-check-input",type:"checkbox",checked:L,onChange:()=>z(!L),id:"notificationEmail"}),(0,l.jsx)("label",{className:"form-check-label",htmlFor:"notificationEmail",children:"Email Notifications"})]}),(0,l.jsxs)("div",{className:"form-check",children:[(0,l.jsx)("input",{className:"form-check-input",type:"checkbox",checked:B,onChange:()=>H(!B),id:"notificationPush"}),(0,l.jsx)("label",{className:"form-check-label",htmlFor:"notificationPush",children:"Push Notifications"})]}),(0,l.jsxs)("div",{className:"form-check",children:[(0,l.jsx)("input",{className:"form-check-input",type:"checkbox",checked:W,onChange:()=>M(!W),id:"notificationSms"}),(0,l.jsx)("label",{className:"form-check-label",htmlFor:"notificationSms",children:"SMS Notifications"})]}),(0,l.jsxs)("div",{className:"mb-2",children:[(0,l.jsx)("label",{className:"form-label",children:"Dashboard Widgets (comma separated)"}),(0,l.jsx)("input",{type:"text",className:"form-control",value:U.join(","),onChange:e=>Z(e.target.value.split(",").map(e=>e.trim()))})]}),(0,l.jsxs)("select",{className:"form-control mb-2",value:G,onChange:e=>K(e.target.value),children:[(0,l.jsx)("option",{value:"dark",children:"Dark"}),(0,l.jsx)("option",{value:"light",children:"Light"})]}),(0,l.jsx)("input",{type:"text",className:"form-control",placeholder:"Currency Display",value:Q,onChange:e=>V(e.target.value)})]})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"password",className:"form-label",children:"Password"}),(0,l.jsx)("input",{type:"password",className:"form-control",id:"password",value:c,onChange:e=>m(e.target.value),required:!0})]}),"login"===a&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(o(),{href:"/forgot-password",className:"text-primary",children:"Forgot Password?"})}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:"login"===a?"Login":"Register"})]})}},7523:(e,a,t)=>{t.d(a,{J1:()=>o,h_:()=>l,iD:()=>s,zu:()=>n});let l=(e,a,t,l)=>{if(localStorage.setItem("accessToken",e),localStorage.setItem("refreshToken",a),localStorage.setItem("userId",t),l)l.email&&localStorage.setItem("userEmail",l.email),l.full_name&&localStorage.setItem("userFullName",l.full_name),l.expires_in&&localStorage.setItem("expiresIn",l.expires_in.toString()),l.token_type&&localStorage.setItem("tokenType",l.token_type);else{let a=function(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}}(e);a&&a.sub&&localStorage.setItem("userId",a.sub)}},s=()=>localStorage.getItem("accessToken"),r=()=>localStorage.getItem("refreshToken"),n=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},o=async()=>{let e=r();if(!e)return null;try{let a=await fetch("".concat("https://travis-2d4m.onrender.com/api/v1","/api/v1/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!a.ok)return n(),null;{let t=await a.json();return l(t.access_token,t.refresh_token||e,JSON.stringify({user_id:t.user_id,email:t.email,full_name:t.full_name,expires_in:t.expires_in,token_type:t.token_type})),t.access_token}}catch(e){return console.error("Error refreshing token:",e),n(),null}}}}]);